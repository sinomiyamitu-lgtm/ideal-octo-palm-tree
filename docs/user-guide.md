# ポートフォリオサイト ユーザー説明書

このドキュメントは、作品カードの閲覧・編集、オフライン閲覧用HTMLのエクスポート、保存やリセット方法を、非開発者にも分かりやすくまとめた説明書です。普段の運用・更新作業にご利用ください。

## 1. 対象読者
- 閲覧者：完成したポートフォリオを見る人
- 編集者：作品カードやプロフィールを更新する人（ログインが必要）

## 2. 画面構成と基本用語
- `閲覧モード`：トップページ（`/`）。作品一覧をカードで表示し、モーダルで詳細を開けます。
- `編集モード`：編集ページ（`/edit`）。カード追加・編集・並び替え、プロフィール編集、エクスポートができます。
- `カード`：1作品の表示ユニット。タイトル、タグ、サムネイル/映像、説明、添付ファイルを持ちます。
- `モーダル`：「もっと見る」で開く詳細パネル。映像/画像、タグ、詳細説明、添付ファイルを表示します。

## 3. 閲覧モード（トップページ）
- 作品カードがグリッドで並びます。
- カードの「もっと見る」を押すとモーダルが開き、詳細情報や埋め込み映像、添付ファイル一覧を表示します。
- プロフィール（表示名・紹介文・アバター・SNS）はページ上部に表示されます（編集モードで更新）。

## 4. 編集モードの使い方
### 4.1 ログイン
- `Edit` リンクをクリックし、パスワードを入力すると編集モードに入れます。
- パスワードは `.env` の `VITE_EDIT_PASSWORD`、または `src/config/auth.json` の `editPassword` を使用します（未設定時の既定値は `edit1234`）。

### 4.2 作品カードの編集
- 左：パレット（カード追加）／中央：カード一覧（ドラッグで並び替え）／右：選択カードの編集フォーム。
- 編集フォーム項目：
  - タイトル、タグ（カンマ区切り）、サブ説明、詳細説明
  - サムネイル画像（URL入力 or ファイルアップロード）
  - 映像URL（YouTube/Vimeo のURLを入力）
- 添付ファイル：フォーム内のファイル選択から複数追加可能。各添付はカードのモーダルに一覧表示され、ダウンロードできます。

### 4.3 プロフィール編集
- 表示名、紹介文、アバター（URLまたは画像ファイル）、SNSリンク（X/Roblox/GitHub/YouTube/TikTok/汎用Link）を編集できます。

### 4.4 並び替え
- カード一覧をドラッグ＆ドロップで順番を変更できます。変更は即時保存されます。

## 5. オフライン閲覧（単一HTMLエクスポート）
- 編集ページ右側の `エクスポート` パネルから以下をダウンロードできます：
  - `viewer.html`：単一ファイルのオフライン閲覧用HTML。
  - `viewer-data.json`：作品とプロフィールのJSON（必要に応じて再読込に利用）。
- 使い方：`viewer.html` をブラウザで開くだけで、作品一覧・モーダル・添付ファイル一覧がオフラインで閲覧できます。
- 映像URLの埋め込み：YouTube と Vimeo を自動判定して `<iframe>` を生成します。`allowfullscreen` を含むため全画面も可能です。
- 添付ファイル：カードに追加した添付は、モーダル内で名称・サイズ等の情報とともにダウンロードリンクとして表示されます（`data:`URLか外部URL）。

## 6. データの保存・バックアップ・リセット
### 6.1 保存場所
- ブラウザの `localStorage` に自動保存します。キーは以下です：
  - 作品：`portfolio_projects`
  - プロフィール：`portfolio_profile`
  - 認証状態：`portfolio_auth`

### 6.2 添付ファイルの保存形式
- 各添付は `{ id, name, mime, size, dataUrl }` を持ちます。
- `dataUrl` は `data:` スキーム（Base64など）で、画像等の中身を文字列として保持します。
- 注意：`localStorage` は保存容量に制限があります。大量・大容量のファイルを添付すると保存に失敗する場合があります。必要に応じて外部URLの利用を検討してください。

### 6.3 リセット（初期化）
- ブラウザの開発者ツール等で次のキーを削除します：
  - `portfolio_projects`, `portfolio_profile`
- ページを再読み込みすると、サンプルデータに戻ります。

## 7. トラブルシューティング
- 開発サーバーのポート競合：`5173` が使用中の場合、`vite` は自動で別ポート（例：`5174`）で起動します。表示されるURLへアクセスしてください。
- 映像が埋め込めない：対応URL（YouTube/Vimeo）か確認し、`https://youtu.be/...` / `https://www.youtube.com/watch?v=...` / `https://vimeo.com/...` を使用。
- 添付のダウンロードが失敗する：`dataUrl` が非常に大きい場合、ブラウザの制限で正しく開けないことがあります。ファイルサイズの削減や外部ホスト利用をご検討ください。
- 認証できない：環境変数 `VITE_EDIT_USER` と `VITE_EDIT_PASSWORD` または `src/config/auth.json` の `editUser` / `editPassword` を確認。既定値は `admin` / `1234`。

## 8. よく使う操作の手順
- 作品を追加：編集モード → 左パレットから追加 → 右フォームで各項目を入力。
- 並び替え：編集モード → 中央のカード一覧をドラッグ＆ドロップ。
- 画像を設定：URLを入力、またはファイル選択でアップロード（アバターも同様）。
- 添付を追加：編集フォームのファイル選択で複数追加 → モーダルに表示されることを確認。
- オフライン版を作成：編集モード → エクスポートパネル → `viewer.html` をダウンロード → ブラウザで開く。

## 9. 開発者向け補足
- 開発起動：`npm run dev` で起動 → `http://localhost:5173`（競合時は `5174`）。
- ビルド：`npm run build`、プレビュー：`npm run preview`。
- 認証の保持：`localStorage` と `Cookie` 両方に保存・削除します（`src/store/session.js`）。
- 既存の `docs/edit-mode.md` は編集UIの仕様・設計メモです。本説明書は運用者向けに、使い方と手順を中心に解説しています。

---

## 10. 進捗一覧と検索（閲覧・オフライン共通）
- 進捗カードの一覧を検索・フィルタできます。以下のUIを提供します：
  - 検索入力（タイトル・説明・タグ・ステータスに対して部分一致）
  - ステータス選択（`all` / `draft` / `in_progress` / `done` / `blocked`）
  - タグバー（クリックで絞り込み、複数選択可）
  - サジェスト（入力に応じてタイトル・タグ・ステータス候補を表示）
  - クリア（検索条件をリセット）
- 進捗カードの詳細モーダル：
  - タイトル、タグ、作成日／更新日、サブ説明、詳細説明、添付ファイル（ダウンロード可）
  - ToDoは閲覧専用です（チェック状態はエクスポート時点のものを表示）
- オフライン版（`viewer.html`）：
  - 上記の進捗検索UIとモーダルが同梱されています。ブラウザで直接開いて同様に操作可能です。
  - 添付は `data:`URLまたは外部URLにより、オフラインでもダウンロードできます。

## 11. エクスポートデータ（参考）
- `viewer-data.json` と `viewer.html` の内部ペイロードには、`projects` / `profile` に加えて `progress` を含みます。
- `progress` の項目例：
  - `id`, `title`, `status`, `tags[]`, `descriptionShort`, `descriptionFull`, `todos[]`, `attachments[]`, `createdAt`, `updatedAt`

不明点や改善希望があれば、担当者へお知らせください。本文書は運用状況に合わせて更新していきます。